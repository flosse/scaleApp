(function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P={}.hasOwnProperty,H=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};i=function(e){var t,n,r;if(e instanceof Array)t=function(){var t,n,i;i=[];for(t=0,n=e.length;t<n;t++)r=e[t],i.push(r);return i}();else{t={};for(n in e)r=e[n],t[n]=r}return t},String.prototype.trim==null&&(String.prototype.trim=function(){return this.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}),l=function(e){var t,n,r,i,s;e==null&&(e=function(){}),n=e.toString().match(/function[^(]*\(([^)]*)\)/);if(n==null||n.length<2)return[];n=n[1],n=n.split(/\s*,\s*/),s=[];for(r=0,i=n.length;r<i;r++)t=n[r],t.trim()!==""&&s.push(t);return s},O=function(e){var t;e==null&&(e=8),t="";while(t.length<e)t+=Math.random().toString(36).substr(2);return t.substr(0,e)},x=function(e,t){var n,r,i,s,o,u,a,f,l;e==null&&(e=[]),t==null&&(t=function(){}),r=e.length,o=[];if(r===0)return typeof t=="function"?t(null,o):void 0;i=[],n=function(){var e;r--;if(r===0)return function(){var t,n,r;r=[];for(t=0,n=i.length;t<n;t++)e=i[t],e!=null&&r.push(e);return r}().length>0?t(i,o):t(null,o)},l=[];for(s=a=0,f=e.length;a<f;s=++a)u=e[s],l.push(function(e,t){var r;r=function(e,r){return e!=null?(i[t]=e,o[t]=void 0):o[t]=r,n()};try{return e(r)}catch(s){return r(s)}}(u,s));return l},a=function(e,t,n){var r,i;return e==null&&(e=[]),i=function(){var n,i,s;s=[];for(n=0,i=e.length;n<i;n++)r=e[n],s.push(function(e){return function(n){return t(e,n)}}(r));return s}(),D.runSeries(i,n)},D={doForAll:a,runSeries:x,clone:i,getArgumentNames:l,uniqueId:O},(typeof module!=="undefined"&&module!==null?module.exports:void 0)!=null&&(module.exports=D),(typeof module!=="undefined"&&module!==null?module.exports:void 0)!=null&&typeof require=="function"&&(D=require("./Util")),e=function(){function e(e,t){this.cascadeChannels=t!=null?t:!1,this.channels={},e&&this.installTo(e)}return e.prototype.subscribe=function(t,n,r){var i,s,o,u,a,f,l,c,h,p,d;r==null&&(r=this),(h=(f=this.channels)[t])==null&&(f[t]=[]),u=this;if(t instanceof Array){p=[];for(l=0,c=t.length;l<c;l++)i=t[l],p.push(this.subscribe(i,n,r));return p}if(typeof t=="object"){d=[];for(s in t)a=t[s],d.push(this.subscribe(s,a,n));return d}return typeof n!="function"?!1:typeof t!="string"?!1:(o={context:r,callback:n},{attach:function(){return u.channels[t].push(o),this},detach:function(){return e._rm(u,t,o.callback),this}}.attach())},e.prototype.on=e.prototype.subscribe,e.prototype.unsubscribe=function(t,n){var r;switch(typeof t){case"string":typeof n=="function"&&e._rm(this,t,n),typeof n=="undefined"&&e._rm(this,t);break;case"function":for(r in this.channels)e._rm(this,r,t);break;case"undefined":for(r in this.channels)e._rm(this,r);break;case"object":for(r in this.channels)e._rm(this,r,null,t)}return this},e.prototype.publish=function(e,t,n){var r,i,s,o,u;return n==null&&(n={}),typeof t=="function"&&(n=t,t=void 0),typeof e!="string"?!1:(o=this.channels[e]||[],t!=null&&n.publishReference!==!0&&typeof t=="object"&&(i=D.clone(t)),u=function(){var n,r,u;u=[];for(n=0,r=o.length;n<r;n++)s=o[n],u.push(function(n){return function(r){try{return D.getArgumentNames(n.callback).length>=3?n.callback.apply(n.context,[i||t,e,r]):r(null,n.callback.apply(n.context,[i||t,e]))}catch(s){return r(s)}}}(s));return u}(),D.runSeries(u,function(e,t){var r,i;return(e!=null?e.length:void 0)>0&&(r=new Error(function(){var t,n,r;r=[];for(t=0,n=e.length;t<n;t++)i=e[t],i!=null&&r.push(i.message);return r}().join("; "))),typeof n=="function"?n(r):void 0}),this.cascadeChannels&&(r=e.split("/")).length>1&&this.publish(r.slice(0,-1).join("/"),t,n),this)},e.prototype.emit=e.prototype.publish,e.prototype.installTo=function(e){var t,n;if(typeof e=="object")for(t in this)n=this[t],e[t]=n;return this},e._rm=function(e,t,n,r){var i;return e.channels[t]=function(){var s,o,u,a;u=e.channels[t],a=[];for(s=0,o=u.length;s<o;s++)i=u[s],(n!=null?i.callback!==n:r!=null?i.context!==r:i.context!==e)&&a.push(i);return a}()},e}(),(typeof module!=="undefined"&&module!==null?module.exports:void 0)!=null&&(module.exports=e),t=function(){function e(e,t,n){this.core=e,this.instanceId=t,this.options=n!=null?n:{};if(this.core==null)throw new TypeError("core was not defined");if(t==null)throw new TypeError("no id was specified");if(typeof t!="string")throw new TypeError("id is not a string")}return e}(),(typeof module!=="undefined"&&module!==null?module.exports:void 0)!=null&&(module.exports=t),(typeof module!=="undefined"&&module!==null?module.exports:void 0)!=null&&typeof require=="function"&&require.amd==null&&(e=require("./Mediator"),t=require("./Sandbox"),D=require("./Util")),n="0.3.8",g={},p={},h={},m=new e,w={},f=function(e){return typeof console!="undefined"&&console!==null?typeof console.error=="function"?console.error(e.message):void 0:void 0},b={_always:[]},y=function(e,t){var n;if(typeof e!="function")throw new Error("expect a function as parameter");n={context:this,callback:e};if(typeof t=="string")return b[t]==null&&(b[t]=[]),b[t].push(n);if(t==null)return b._always.push(n)},c=function(e,t,n){var r,i,s,o,u;s={},u=t.options;for(i in u)o=u[i],s[i]=o;r=h[e];if(r)for(i in r)o=r[i],s[i]=o;if(n)for(i in n)o=n[i],s[i]=o;return s},u=function(e,n,r){var i,o,u,a,f,l,h,d,v,y,E,S,x,T,N,C,k;n==null&&(n=e),l=g[e];if(p[n]!=null)return p[n];u=c(n,l,r),y=new t(s,n,u),m.installTo(y);for(o in w){d=w[o];if(d.sandbox==null)continue;v=new d.sandbox(y);for(f in v){if(!P.call(v,f))continue;E=v[f],y[f]=E}}a=new l.creator(y),a.options=u,a.id=n,p[n]=a,C=[n,"_always"];for(S=0,T=C.length;S<T;S++){h=C[S];if(b[h]!=null){k=b[h];for(x=0,N=k.length;x<N;x++)i=k[x],i.callback.apply(i.context)}}return a},r=function(e,t,n){var r;if(typeof e!="string")throw new TypeError("module ID has to be a string");if(typeof t!="function")throw new TypeError("creator has to be a constructor function");if(typeof n!="object")throw new TypeError("option parameter has to be an object");r=new t;if(typeof r!="object")throw new TypeError("creator has to return an object");if(typeof r.init!="function")throw new TypeError("module has to have an init function");if(typeof r.destroy!="function")throw new TypeError("module has to have a destroy function");if(g[e]!=null)throw new TypeError("module "+e+" was already registered");return g[e]={creator:t,options:n,id:e},!0},E=function(e,t,n){n==null&&(n={});try{return r(e,t,n)}catch(i){return f(new Error("could not register module '"+e+"': "+i.message)),!1}},N=function(e,t){var n,r,i,s;if(typeof e!="string")throw new TypeError("instance ID has to be a string");if(typeof t!="object")throw new TypeError("option parameter has to be an object");(i=h[e])==null&&(h[e]={}),s=[];for(n in t)r=t[n],s.push(h[e][n]=r);return s},M=function(e){return g[e]!=null?(delete g[e],!0):!1},_=function(){var e,t;t=[];for(e in g)t.push(M(e));return t},C=function(e,t){var n;t==null&&(t={});try{if(typeof e!="string")throw new Error("module ID has to be a string");if(typeof t!="object")throw new Error("second parameter has to be an object");if(g[e]==null)throw new Error("module does not exist");n=u(e,t.instanceId,t.options);if(n.running===!0)throw new Error("module was already started");return D.getArgumentNames(n.init).length>=2?n.init(n.options,function(e){return typeof t.callback=="function"?t.callback(e):void 0}):(n.init(n.options),typeof t.callback=="function"&&t.callback(null)),n.running=!0,!0}catch(r){return f(r),typeof t.callback=="function"&&t.callback(new Error("could not start module: "+r.message)),!1}},L=function(e,t){var n;return(n=p[e])?(m.unsubscribe(n),D.getArgumentNames(n.destroy).length>=1?n.destroy(function(e){return typeof t=="function"?t(e):void 0}):(n.destroy(),typeof t=="function"&&t(null)),delete p[e],!0):!1},k=function(e,t){var n,r,i,s,o,u,a;return e instanceof Array?(s=e,e=t,t=null,u=function(){var e,t,r;r=[];for(e=0,t=s.length;e<t;e++)n=s[e],g[n]!=null&&r.push(n);return r}()):s=u=function(){var e;e=[];for(n in g)e.push(n);return e}(),u.length===(a=s.length)&&a===0?(typeof e=="function"&&e(null),!0):(u.length!==s.length&&(r=function(){var e,t,r;r=[];for(e=0,t=s.length;e<t;e++)n=s[e],H.call(u,n)>=0||r.push("'"+n+"'");return r}(),i=new Error("these modules don't exist: "+r)),o=function(e,t){var n,r,i,s;i={},r=g[e].options;for(n in r){if(!P.call(r,n))continue;s=r[n],s&&(i[n]=s)}return i.callback=function(e){return typeof r.callback=="function"&&r.callback(e),t(e)},C(e,i)},D.doForAll(u,o,function(t){var n,r,s;return(t!=null?t.length:void 0)>0&&(n=new Error("errors occoured in the following modules: "+function(){var e,n,i;i=[];for(r=e=0,n=t.length;e<n;r=++e)s=t[r],s!=null&&i.push("'"+u[r]+"'");return i}())),typeof e=="function"?e(n||i):void 0}),i==null)},A=function(e){var t;return D.doForAll(function(){var e;e=[];for(t in p)e.push(t);return e}(),L,e)},o=["VERSION","register","unregister","registerPlugin","start","stop","startAll","stopAll","publish","subscribe","unsubscribe","on","emit","setInstanceOptions","Mediator","Sandbox","unregisterAll","uniqueId","lsModules","lsInstances"],T=["core","instanceId","options","publish","emit","on","subscribe","unsubscribe"],v=function(){var e,t,n;n=[];for(e in g)t=g[e],n.push(e);return n},d=function(){var e,t,n;n=[];for(e in p)t=p[e],n.push(e);return n},S=function(e){var n,r,i,u;try{if(typeof e!="object")throw new Error("plugin has to be an object");if(typeof e.id!="string")throw new Error("plugin has no id");if(typeof e.sandbox=="function"){for(n in new e.sandbox(new t(s,"")))if(H.call(T,n)>=0)throw new Error("plugin uses reserved keyword");i=e.sandbox.prototype;for(n in i)r=i[n],t.prototype[n]=r}if(typeof e.core=="object"){for(n in e.core)if(H.call(o,n)>=0)throw new Error("plugin uses reserved keyword");u=e.core;for(n in u)r=u[n],s[n]=r,typeof exports!="undefined"&&exports!==null&&(exports[n]=r)}return typeof e.onInstantiate=="function"&&y(e.onInstantiate),w[e.id]=e,!0}catch(a){return f(a),!1}},s={VERSION:n,register:E,unregister:M,unregisterAll:_,registerPlugin:S,setInstanceOptions:N,start:C,stop:L,startAll:k,stopAll:A,uniqueId:D.uniqueId,lsInstances:d,lsModules:v,util:D,Mediator:e,Sandbox:t,subscribe:function(){return m.subscribe.apply(m,arguments)},on:function(){return m.subscribe.apply(m,arguments)},unsubscribe:function(){return m.unsubscribe.apply(m,arguments)},publish:function(){return m.publish.apply(m,arguments)},emit:function(){return m.publish.apply(m,arguments)}},(typeof module!=="undefined"&&module!==null?module.exports:void 0)!=null&&(module.exports=s),(typeof define!=="undefined"&&define!==null?define.amd:void 0)!=null?(typeof define!=="undefined"&&define!==null?define.amd:void 0)!=null&&define(function(){return s}):typeof window!="undefined"&&window!==null&&(window.scaleApp=s)}).call(this),function(){var e,t,n;t=function(e,t,n){var r,i,s,o;if(n===!0){s=[];for(r in e)i=e[r],s.push(t[r]=i);return s}o=[];for(r in e)i=e[r],t.hasOwnProperty(r)||o.push(t[r]=i);return o},e=function(){function e(e){}return e.prototype.countObjectKeys=function(e){var t,n;if(typeof e=="object")return function(){var r;r=[];for(t in e)n=e[t],r.push(t);return r}().length},e.prototype.mixin=function(e,n,r){r==null&&(r=!1);switch(""+typeof n+"-"+typeof e){case"function-function":return t(n.prototype,e.prototype,r);case"function-object":return t(n.prototype,e,r);case"object-object":return t(n,e,r);case"object-function":return t(n,e.prototype,r)}},e}(),n={id:"util",sandbox:e},typeof scaleApp!="undefined"&&scaleApp!==null&&scaleApp.registerPlugin(n),(typeof module!=="undefined"&&module!==null?module.exports:void 0)!=null&&(module.exports=n),(typeof define!=="undefined"&&define!==null?define.amd:void 0)!=null&&define(function(){return n})}.call(this),function(){var e,t,n,r,i,s=function(e,t){return function(){return e.apply(t,arguments)}},o={}.hasOwnProperty,u=function(e,t){function r(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e},a=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};i=(typeof window!="undefined"&&window!==null?window.scaleApp:void 0)||(typeof require=="function"?require("../scaleApp"):void 0),n=function(e){return""+e+"/leave"},t=function(e){return""+e+"/enter"},e=function(e){function r(e){var n,i,o;e==null&&(e={}),this.fire=s(this.fire,this),r.__super__.constructor.call(this),this.states=[],this.transitions={},e.states!=null&&this.addState(e.states),e.start!=null&&(this.addState(e.start),this.start=e.start,this.current=e.start,this.emit(t(this.start)));if(e.transitions!=null){o=e.transitions;for(n in o)i=o[n],this.addTransition(n,i)}}return u(r,e),r.prototype.start=null,r.prototype.current=null,r.prototype.exit=null,r.prototype.addState=function(e,r){var i,s,o,u;return r==null&&(r={}),e instanceof Array?!(a.call(function(){var t,n,r;r=[];for(t=0,n=e.length;t<n;t++)s=e[t],r.push(this.addState(s));return r}.call(this),!1)>=0):typeof e=="object"?!(a.call(function(){var t;t=[];for(i in e)u=e[i],t.push(this.addState(i,u));return t}.call(this),!1)>=0):typeof e!="string"?!1:a.call(this.states,e)>=0?!1:(this.states.push(e),o=[],r.enter!=null&&o.push(this.on(t(e),r.enter)),r.leave!=null&&o.push(this.on(n(e),r.leave)),!(a.call(o,!1)>=0))},r.prototype.addTransition=function(e,t){var n,r,i;if(typeof e=="string"&&typeof t.to=="string"&&this.transitions[e]==null&&(i=t.to,a.call(this.states,i)>=0)){if(t.from instanceof Array){n=a.call(function(){var e,n,i,s;i=t.from,s=[];for(e=0,n=i.length;e<n;e++)r=i[e],s.push(a.call(this.states,r)>=0);return s}.call(this),!1)>=0;if(n!==!1)return!1}else if(typeof t.from!="string")return!1;return this.transitions[e]={from:t.from,to:t.to},!0}return!1},r.prototype.onEnter=function(e,n){var r;return(r=!e,a.call(this.states,r)>=0)?!1:this.on(t(e),n)},r.prototype.onLeave=function(e,t){var r;return(r=!e,a.call(this.states,r)>=0)?!1:this.on(n(e),t)},r.prototype.fire=function(e,r){var i,s=this;return r==null&&(r=function(){}),i=this.transitions[e],i==null||!this.can(e)?!1:(this.emit(n(this.current),i,function(e){return e!=null?r(e):s.emit(t(i.to),i,function(e){return e==null&&(s.current=i.to),r(e)})}),!0)},r.prototype.can=function(e){var t,n;return t=this.transitions[e],(t!=null?t.from:void 0)===this.current||(n=this.current,a.call(t.from,n)>=0)||t.from==="*"},r}(i.Mediator),r={id:"state",core:{StateMachine:e}},(typeof window!=="undefined"&&window!==null?window.scaleApp:void 0)!=null&&i.registerPlugin(r),(typeof module!=="undefined"&&module!==null?module.exports:void 0)!=null&&(module.exports=r),(typeof define!=="undefined"&&define!==null?define.amd:void 0)!=null&&define(function(){return r})}.call(this),function(){var e,t,n,r,i,s={}.hasOwnProperty,o=function(e,t){function r(){this.constructor=e}for(var n in t)s.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};i=(typeof window!="undefined"&&window!==null?window.scaleApp:void 0)||(typeof require=="function"?require("../scaleApp"):void 0),t=function(e){function t(e){var n,r;t.__super__.constructor.call(this),this.id=(e!=null?e.id:void 0)||i.uniqueId();for(n in e)r=e[n],this[n]==null&&(this[n]=r)}return o(t,e),t.prototype.set=function(e,n,r){var i,s;r==null&&(r=!1);switch(typeof e){case"object":for(i in e)s=e[i],this.set(i,s,!0);r||this.publish(t.CHANGED,function(){var t;t=[];for(i in e)s=e[i],t.push(i);return t}());break;case"string":e!=="set"&&e!=="get"&&this[e]!==n&&(this[e]=n,r||this.publish(t.CHANGED,[e]));break;default:typeof console!="undefined"&&console!==null&&typeof console.error=="function"&&console.error("key is not a string")}return this},t.prototype.change=function(e,n){if(typeof e=="function")return this.subscribe(t.CHANGED,e,n);if(arguments.length===0)return this.publish(t.CHANGED)},t.prototype.notify=function(){return this.change()},t.prototype.get=function(e){return this[e]},t.prototype.toJSON=function(){var e,t,n;e={};for(t in this){if(!s.call(this,t))continue;n=this[t],e[t]=n}return e},t.CHANGED="changed",t}(i.Mediator),n=function(){function e(e){e&&this.setModel(e)}return e.prototype.setModel=function(e){return this.model=e,this.model.change(function(){return this.render()},this)},e.prototype.render=function(){},e}(),e=function(){function e(e,t){this.model=e,this.view=t}return e}(),r={id:"mvc",core:{Model:t,View:n,Controller:e}},(typeof window!=="undefined"&&window!==null?window.scaleApp:void 0)!=null&&i.registerPlugin(r),(typeof module!=="undefined"&&module!==null?module.exports:void 0)!=null&&(module.exports=r),(typeof define!=="undefined"&&define!==null?define.amd:void 0)!=null&&define(function(){return r})}.call(this),function(){var e,t,n=function(e,t){return function(){return e.apply(t,arguments)}};e=function(){function e(e){this.sb=e,this.getContainer=n(this.getContainer,this)}return e.prototype.getContainer=function(){switch(typeof this.sb.options.container){case"string":return document.getElementById(this.sb.options.container);case"object":return this.sb.options.container;default:return document.getElementById(this.sb.instanceId)}},e}(),t={id:"dom",sandbox:e},window.scaleApp!=null&&window.scaleApp.registerPlugin(t),(typeof module!=="undefined"&&module!==null?module.exports:void 0)!=null&&(module.exports=t),(typeof define!=="undefined"&&define!==null?define.amd:void 0)!=null&&define(function(){return t})}.call(this),function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g=[].slice;e=(typeof window!="undefined"&&window!==null?(m=window.scaleApp)!=null?m.Mediator:void 0:void 0)||(typeof require=="function"?require("../Mediator"):void 0),n="en",s=function(){return((typeof navigator!="undefined"&&navigator!==null?navigator.language:void 0)||(typeof navigator!="undefined"&&navigator!==null?navigator.browserLanguage:void 0)||n).split("-")[0]},f=s(),l=new e,r="i18n",a={},d=function(){return l.subscribe.apply(l,[r].concat(g.call(arguments)))},v=function(){return l.unsubscribe.apply(l,[r].concat(g.call(arguments)))},o=function(){return f},p=function(e){if(typeof e=="string")return f=e,l.publish(r,f)},h=function(e){return typeof e=="object"?(a=e,!0):!1},u=function(e,t,n){var r,i;return((r=t[n])!=null?r[e]:void 0)||((i=a[n])!=null?i[e]:void 0)},i=function(e,t){return t==null&&(t={}),u(e,t,f)||u(e,t,f.substring(0,2))||u(e,t,n)||e},t=function(){function e(e){this.sb=e}return e.prototype.i18n={subscribe:d,on:d,unsubscribe:v},e.prototype._=function(e){return i(e,this.sb.options.i18n)},e.prototype.getLanguage=o,e}(),c={id:"i18n",sandbox:t,core:{i18n:{setLanguage:p,getBrowserLanguage:s,getLanguage:o,baseLanguage:n,get:i,subscribe:d,on:d,unsubscribe:v,setGlobal:h}}},(typeof window!=="undefined"&&window!==null?window.scaleApp:void 0)!=null&&typeof window!="undefined"&&window!==null&&window.scaleApp.registerPlugin(c),(typeof module!=="undefined"&&module!==null?module.exports:void 0)!=null&&(module.exports=c),(typeof define!=="undefined"&&define!==null?define.amd:void 0)!=null&&define(function(){return c})}.call(this),function(){var e,t,n,r,i,s,o,u,a,f;e=(typeof window!="undefined"&&window!==null?(f=window.scaleApp)!=null?f.Mediator:void 0:void 0)||(typeof require=="function"?require("../Mediator"):void 0),s={},n=function(e,t){var n,r;return n=(r=s[e])!=null?r:s[e]={},n[t]=!0},u=function(e,t){var n;return n=s[e],n==null?!1:(delete n[t],!0)},i=function(e,t){var n,r;return n=(r=s[e])!=null?r[t]:void 0,n!=null?!0:(console.warn(""+e+" has no permissions for '"+t+"'"),!1)},r=function(e,t,n,r){var s;return s=i(e.instanceId,t),s===!0?n.apply(e,r):!1},a=function(e,t){var n;n=e[t];if(typeof n=="function")return e[t]=function(){return r(e,t,n,arguments)}},t=function(){function e(e){a(e,"subscribe"),a(e,"publish"),a(e,"unsubscribe")}return e}(),o={id:"permission",sandbox:t,core:{permission:{add:n,remove:u}}},(typeof window!=="undefined"&&window!==null?window.scaleApp:void 0)!=null&&window.scaleApp.registerPlugin(o),(typeof module!=="undefined"&&module!==null?module.exports:void 0)!=null&&(module.exports=o),(typeof define!=="undefined"&&define!==null?define.amd:void 0)!=null&&define(function(){return o})}.call(this);